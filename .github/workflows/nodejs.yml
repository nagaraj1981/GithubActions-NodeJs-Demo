---
name: Matrix workflow to run nodejs build
on: 
  workflow_dispatch:
  push:
    branches:
     - master
  pull_request:
    branches:
     - master
jobs:
    Job1:
      continue-on-error: true  #continue to run the job even if there is an error
      strategy:
       matrix:
         operating_system: [ubuntu-latest,windows-latest]
         artifact_name: [artifact-node-ubuntu,artifact-node-windows]
         exclude:
         - operating system: ubuntu-latest
           artifact_name: artifact-node-windows
         - operating system: windows-latest
           artifact_name: artifact-node-ubuntu
      runs-on: ${{ matrix.operating_system }}
      steps:
        - name: clone the repo
          uses: actions/checkout@v6
        - name: Install nodejs
          uses: actions/setup-node@v6
          with:
            node-version: 18
            cache: 'npm'
        - name: Install node dependencies
          run: npm ci
        - name: Execute test cases
          run: npm test
        - name: Build the nodejs command
          run: npm run build
        - name: upload artifact to github repo
          uses: actions/upload-artifact@v4
          with:
            name: ${{ matrix.artifact_name }}
            path: dist/
